
# Yum install #
yum -y update
yum -y groupinstall "Development Tools"
yum -y install git nginx mysql

# Top level dirs #

mkdir /kfly
mkdir /data
(future: /data might be a symlink to a separate volume)

# Git Checkout #

cd /kfly
git init
git remote add origin https://XXX@github.com/andyfischer/kidfriendly.git
  (where XXX is a token generated from Github.com)

Change .git/config to have:

[receive]
    denyCurrentBranch=false

# Building Node #

cd /kfly/3rdparty
wget http://nodejs.org/dist/v0.10.31/node-v0.10.31.tar.gz
cd node-v0.10.31
sudo ./configure
sudo make
sudo make install

# Dev user account #

Add this to .bash_profile: PATH=$PATH:/kfly/server/tools:$HOME/bin

Install global node tools:

sudo npm install -g coffee-script

# Sudo setup #

sudo visudo
(add /usr/local/bin to secure_path)

# Symlinks #

  /etc/init/forever.conf -> /kfly/server/scripts/forever.conf
  /etc/profile.d/kfly.sh -> /kfly/server/scripts/profile.d.sh
  /etc/nginx/conf.d/kfly.conf -> /kfly/server/scripts/nginx.conf

# Updating upstart configuration #

sudo initctl reload-configuration

or just: ~/bin/init-reload

# Starting forever #
sudo start forever

# Docker #

(Found instructions at: http://www.liquidweb.com/kb/how-to-install-docker-on-centos-6/ )

sudo rpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
yum update -y
yum -y install docker-io
service docker start
chkconfig docker on
sudo groupadd docker
sudo gpasswd -a dev docker
(now logout & login)
sudo service docker restart

# Mysql from docker #

# Useful links:
#   https://github.com/tutumcloud/tutum-docker-mysql
cd /kfly/3rdparty
git clone https://github.com/tutumcloud/tutum-docker-mysql
docker build -t tutum/mysql 5.5
scripts/mysql-run.sh
docker ps
